<controls:BaseWindow x:Class="Tracker.MainWindow"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:local="clr-namespace:Tracker"
                     xmlns:controls="clr-namespace:Tracker.Controls"
                     xmlns:languages="clr-namespace:Tracker.Resources.Languages"
                     xmlns:commands="clr-namespace:Tracker.Command"
                     xmlns:enums="clr-namespace:Tracker.Common.Enums"
                     xmlns:dialogViewModels="clr-namespace:Tracker.ViewModels.DialogViewModels"
                     xmlns:viewModels="clr-namespace:Tracker.ViewModels"
                     xmlns:attachedProperties="clr-namespace:Tracker.AttachedProperties"
                     xmlns:converters="clr-namespace:Tracker.Common.Converters"
                     mc:Ignorable="d"
                     MouseDown="OnDragHandleMouseDown"
                     WindowStyle="None"
                     WindowStartupLocation="CenterScreen"
                     ResizeMode="CanResize"
                     AllowsTransparency="True"
                     Background="Transparent"
                     Title="MainWindow"
                     Height="450"
                     Width="800"
                     d:DataContext="{d:DesignInstance Type=viewModels:TrackerMainViewModel}">
    <controls:BaseWindow.Resources>
        <Style TargetType="{x:Type TabControl}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabControl}">
                        <Grid>
                            <!-- Tab Panel -->
                            <StackPanel Grid.Column="0"
                                        IsItemsHost="True"
                                        Orientation="Vertical"
                                        VerticalAlignment="Stretch"
                                        HorizontalAlignment="Stretch"
                                        Background="{DynamicResource BackgroundBrush}">
                            </StackPanel>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type TabItem}">
            <Setter Property="Padding"
                    Value="12,7" />
            <Setter Property="Margin"
                    Value="0,0,0,2" />
            <Setter Property="Background"
                    Value="{DynamicResource BackgroundBrush}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource ForegroundBrush}" />
            <Setter Property="HorizontalAlignment"
                    Value="Stretch" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{DynamicResource ForegroundBrush}"
                                BorderThickness="0"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="4">
                            <Grid HorizontalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition x:Name="Spacer"
                                                      Width="8" />
                                    <ColumnDefinition x:Name="ContentColumn"
                                                      Width="*" />
                                </Grid.ColumnDefinitions>
                                <Path Grid.Column="0"
                                      Stretch="Uniform"
                                      Fill="{TemplateBinding Foreground}"
                                      Data="{Binding RelativeSource={RelativeSource TemplatedParent},
                                             Path=(attachedProperties:TabItemExtensions.IconData)}" />
                                <ContentPresenter ContentSource="Header"
                                                  Grid.Column="2"
                                                  MinWidth="125"
                                                  Margin="0,0,0,0"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabControl}, Path=(attachedProperties:TabControlExtensions.IsCollapsed)}"
                                         Value="True">
                                <Setter TargetName="ContentColumn"
                                        Property="Width"
                                        Value="0" />
                                <Setter TargetName="Spacer"
                                        Property="Width"
                                        Value="0" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabControl}, Path=(attachedProperties:TabControlExtensions.IsCollapsed)}"
                                         Value="False">
                                <Setter TargetName="ContentColumn"
                                        Property="Width"
                                        Value="*" />
                                <Setter TargetName="Spacer"
                                        Property="Width"
                                        Value="8" />
                            </DataTrigger>
                            <Trigger Property="IsSelected"
                                     Value="True">
                                <Setter Property="Background"
                                        Value="{DynamicResource ForegroundBrush}" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource BackgroundBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </controls:BaseWindow.Resources>
    <Grid>
        <Border Background="{DynamicResource BackgroundBrush}"
                CornerRadius="12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="5" />
                </Grid.RowDefinitions>
                <Border Grid.Row="0"
                        Height="Auto"
                        Background="{DynamicResource BackgroundBrush}"
                        CornerRadius="12,12,0,0">
                    <controls:DialogTitleBar x:Name="TitleBar"
                                             CloseClicked="Close_Click"
                                             MinimizeClicked="Minimize_Click"
                                             MaximizeClicked="Maximize_Click"
                                             RestoreClicked="Restore_Click" />
                </Border>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="12" />
                        <ColumnDefinition Width="Auto"
                                          MaxWidth="250" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="12" />
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0"
                            Grid.Row="0"
                            CornerRadius="0,0,0,12"
                            Background="{DynamicResource BackgroundBrush}"
                            Grid.ColumnSpan="2" />
                    <TabControl x:Name="TabControl"
                                SelectionChanged="TabChangedEventHandler"
                                Grid.Column="1"
                                Margin="0,0,5,0">
                        <TabItem x:Name="Team"
                                 Header="My Team"
                                 attachedProperties:TabItemExtensions.IconData="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z" />
                        <TabItem x:Name="OneOnOne"
                                 Header="1:1s"
                                 attachedProperties:TabItemExtensions.IconData="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z" />
                        <TabItem x:Name="Projects"
                                 Header="Projects"
                                 attachedProperties:TabItemExtensions.IconData="M12.6,2.86C15.27,4.1 18,5.39 20.66,6.63C20.81,6.7 21,6.75 21,6.95C21,7.15 20.81,7.19 20.66,7.26C18,8.5 15.3,9.77 12.62,11C12.21,11.21 11.79,11.21 11.38,11C8.69,9.76 6,8.5 3.32,7.25C3.18,7.19 3,7.14 3,6.94C3,6.76 3.18,6.71 3.31,6.65C6,5.39 8.74,4.1 11.44,2.85C11.73,2.72 12.3,2.73 12.6,2.86M12,21.15C11.8,21.15 11.66,21.07 11.38,20.97C8.69,19.73 6,18.47 3.33,17.22C3.19,17.15 3,17.11 3,16.9C3,16.7 3.19,16.66 3.34,16.59C3.78,16.38 4.23,16.17 4.67,15.96C5.12,15.76 5.56,15.76 6,15.97C7.79,16.8 9.57,17.63 11.35,18.46C11.79,18.67 12.23,18.66 12.67,18.46C14.45,17.62 16.23,16.79 18,15.96C18.44,15.76 18.87,15.75 19.29,15.95C19.77,16.16 20.24,16.39 20.71,16.61C20.78,16.64 20.85,16.68 20.91,16.73C21.04,16.83 21.04,17 20.91,17.08C20.83,17.14 20.74,17.19 20.65,17.23C18,18.5 15.33,19.72 12.66,20.95C12.46,21.05 12.19,21.15 12,21.15M12,16.17C11.9,16.17 11.55,16.07 11.36,16C8.68,14.74 6,13.5 3.34,12.24C3.2,12.18 3,12.13 3,11.93C3,11.72 3.2,11.68 3.35,11.61C3.8,11.39 4.25,11.18 4.7,10.97C5.13,10.78 5.56,10.78 6,11C7.78,11.82 9.58,12.66 11.38,13.5C11.79,13.69 12.21,13.69 12.63,13.5C14.43,12.65 16.23,11.81 18.04,10.97C18.45,10.78 18.87,10.78 19.29,10.97C19.76,11.19 20.24,11.41 20.71,11.63C20.77,11.66 20.84,11.69 20.9,11.74C21.04,11.85 21.04,12 20.89,12.12C20.84,12.16 20.77,12.19 20.71,12.22C18,13.5 15.31,14.75 12.61,16C12.42,16.09 12.08,16.17 12,16.17Z" />
                        <TabItem x:Name="Tasks"
                                 Header="Tasks"
                                 attachedProperties:TabItemExtensions.IconData="M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2,4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z" />
                        <TabItem x:Name="Okrs"
                                 Header="OKRs"
                                 attachedProperties:TabItemExtensions.IconData="M11,2V4.07C7.38,4.53 4.53,7.38 4.07,11H2V13H4.07C4.53,16.62 7.38,19.47 11,19.93V22H13V19.93C16.62,19.47 19.47,16.62 19.93,13H22V11H19.93C19.47,7.38 16.62,4.53 13,4.07V2M11,6.08V8H13V6.09C15.5,6.5 17.5,8.5 17.92,11H16V13H17.91C17.5,15.5 15.5,17.5 13,17.92V16H11V17.91C8.5,17.5 6.5,15.5 6.08,13H8V11H6.09C6.5,8.5 8.5,6.5 11,6.08M12,11A1,1 0 0,0 11,12A1,1 0 0,0 12,13A1,1 0 0,0 13,12A1,1 0 0,0 12,11Z" />
                        <TabItem x:Name="Kpis"
                                 Header="KPIs"
                                 attachedProperties:TabItemExtensions.IconData="M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z" />
                    </TabControl>
                    <Button Style="{StaticResource ExpansionButtonStyle}"
                            VerticalAlignment="Bottom"
                            Panel.ZIndex="99"
                            Grid.Column="1"
                            Width="30"
                            Margin="0,0, -15,05"
                            HorizontalAlignment="Right"
                            Command="{x:Static attachedProperties:TabControlExtensions.ToggleCollapseCommand}"
                            CommandParameter="{Binding ElementName=TabControl}" />

                    <controls:TeamMembersControl x:Name="TeamControl"
                                                 Grid.Column="3"
                                                 IsHitTestVisible="{Binding ElementName=Team, Path=IsSelected}"
                                                 RenderTransformOrigin="1,0"
                                                 Opacity="{Binding ElementName=Team, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:TeamMembersControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:TeamMembersControl.RenderTransform>
                    </controls:TeamMembersControl>
                    <controls:OneOnOnesControl x:Name="OneOnOnesControl"
                                               Grid.Column="3"
                                               IsHitTestVisible="{Binding ElementName=OneOnOne, Path=IsSelected}"
                                               RenderTransformOrigin="1,0"
                                               Opacity="{Binding ElementName=OneOnOne, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:OneOnOnesControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:OneOnOnesControl.RenderTransform>
                    </controls:OneOnOnesControl>
                    <controls:ProjectsControl x:Name="ProjectsControl"
                                              Grid.Column="3"
                                              IsHitTestVisible="{Binding ElementName=Projects, Path=IsSelected}"
                                              RenderTransformOrigin="1,0"
                                              Opacity="{Binding ElementName=Projects, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:ProjectsControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:ProjectsControl.RenderTransform>
                    </controls:ProjectsControl>
                    <controls:TasksControl x:Name="TasksControl"
                                           Grid.Column="3"
                                           RenderTransformOrigin="1,0"
                                           IsHitTestVisible="{Binding ElementName=Tasks, Path=IsSelected}"
                                           Opacity="{Binding ElementName=Tasks, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:TasksControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:TasksControl.RenderTransform>
                    </controls:TasksControl>
                    <controls:OkrsControl x:Name="OkrsControl"
                                          Grid.Column="3"
                                          RenderTransformOrigin="1,0"
                                          IsHitTestVisible="{Binding ElementName=Okrs, Path=IsSelected}"
                                          Opacity="{Binding ElementName=Okrs, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:OkrsControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:OkrsControl.RenderTransform>
                    </controls:OkrsControl>
                    <controls:KpisControl x:Name="KpisControl"
                                          Grid.Column="3"
                                          RenderTransformOrigin="1,0"
                                          IsHitTestVisible="{Binding ElementName=Kpis, Path=IsSelected}"
                                          Opacity="{Binding ElementName=Kpis, Path=IsSelected, Converter={x:Static converters:BooleanToOpacityConverter.Instance}}">
                        <controls:KpisControl.RenderTransform>
                            <TranslateTransform X="0" />
                        </controls:KpisControl.RenderTransform>
                    </controls:KpisControl>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</controls:BaseWindow>
